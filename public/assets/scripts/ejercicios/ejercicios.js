document.addEventListener("DOMContentLoaded",(function(){$("#tblEjecutandoEjercicios tbody").on("dblclick","tr",(function(){let e=tblEjecutandoEjercicios.row(this).data();tblEjecutandoEjercicios.rows().data(),tblEjecutandoEjercicios.row(this).index();console.log(e),$("#ejerciciosmodal").modal("show"),$("#ejerciciosmodal").on("hidden.bs.modal",(function(e){}))})),$("#ejerciciosmodal").on("hidden.bs.modal",(function(e){}));const e=document.getElementById("id_persona");e.addEventListener("change",(()=>{""==e.value?Swal.fire("Usuario!","Debe seleccionar un paciente!","warning"):cargarEdad(e.value)}))}));let tblEjercicios=$("#tblEjercicios").DataTable({aProcessing:!0,aServerSide:!0,bFilter:!0,scrollX:!1,language:{decimal:"",emptyTable:"No hay información",info:"Mostrando _START_ a _END_ de _TOTAL_ Entradas",infoEmpty:"Mostrando 0 to 0 of 0 Entradas",infoFiltered:"(Filtrado de _MAX_ total entradas)",infoPostFix:"",thousands:",",lengthMenu:"Mostrar _MENU_ Entradas",loadingRecords:"Cargando...",processing:"Procesando...",search:"Buscar:",zeroRecords:"Sin resultados encontrados",paginate:{first:"Primero",last:"Ultimo",next:"Siguiente",previous:"Anterior"}},dom:"Bfrtip",buttons:[{extend:"pdf",title:"Listado de Ejercicios",filename:"listado_ejercicios",text:'Exportar a PDF <i class="fa fa-file-pdf"></i>'},{extend:"excelHtml5",title:"Listado de Ejercicios",filename:"listado_ejercicios",text:'Exportar a Excel <i class="fa fa-file-excel"></i>'}],lengthChange:!1,bDestroy:!0,iDisplayLength:10,order:[[0,"desc"]]}),tblEjecutandoEjercicios=$("#tblEjecutandoEjercicios").DataTable({select:{style:"os",selector:"td:first-child"},aProcessing:!0,aServerSide:!0,bFilter:!1,scrollX:!1,paging:!1,bInfo:!1,language:{decimal:"",emptyTable:"No hay información",info:"Mostrando _START_ a _END_ de _TOTAL_ Entradas",infoEmpty:"Mostrando 0 to 0 of 0 Entradas",infoFiltered:"(Filtrado de _MAX_ total entradas)",infoPostFix:"",thousands:",",lengthMenu:"Mostrar _MENU_ Entradas",loadingRecords:"Cargando...",processing:"Procesando...",search:"Buscar:",zeroRecords:"Sin resultados encontrados",paginate:{first:"Primero",last:"Ultimo",next:"Siguiente",previous:"Anterior"}},dom:"Bfrtip",buttons:[],lengthChange:!1,bDestroy:!0,iDisplayLength:10,order:[[0,"desc"]],columnDefs:[{visible:!1,targets:3},{visible:!1,targets:4},{visible:!1,targets:5},{visible:!1,targets:6}]});const init=()=>{cargarPacientes(),cargarTest()};let formulario=$("#formulario"),principal=$("#principal");document.getElementById("BtnMostrarFormulario").onclick=function(){principal.hide(),formulario.show(),$("#btnGuardarRegistro").show(),$("#btnActualizarRegistro").hide()};const cargarTest=()=>{axios.get("listartiposevaluaciones").then((e=>{let a=e.data;const i=[{n_id:-1,n_title:"PictsApp Tests",n_parentid:0,n_checkStatus:!1}];a.forEach((e=>{i.push({n_id:e.id_tipo_evaluacion,n_title:e.tipo_evaluacion,n_parentid:e.padre,n_checkStatus:!1,n_elements:1==e.es_ejercicio?[{icon:1==e.es_practica?"fas fa-broom":"far fa-check-circle",title:1==e.es_practica?"Iniciar Practica":"Es Evaluación",onClick:a=>{let i=e.id_tipo_evaluacion;switch(console.log(i),e.nivel){case 1:""==id_persona.value?Swal.fire("Usuario!","Debe seleccionar un paciente!","warning"):edad.value>=3&&edad.value<=4?cargarEjercicio(e.id_tipo_evaluacion):Swal.fire("Usuario!","Este nivel no corresponde a la edad del niño!","error");break;case 2:""==id_persona.value?Swal.fire("Usuario!","Debe seleccionar un paciente!","warning"):edad.value>=5&&edad.value<=6?cargarEjercicio(e.id_tipo_evaluacion):Swal.fire("Usuario!","Este nivel no corresponde a la edad del niño!","error");break;case 3:""==id_persona.value?Swal.fire("Usuario!","Debe seleccionar un paciente!","warning"):edad.value>=7&&edad.value<=8?cargarEjercicio(e.id_tipo_evaluacion):Swal.fire("Usuario!","Este nivel no corresponde a la edad del niño!","error");break;default:""==id_persona.value?Swal.fire("Usuario!","Debe seleccionar un paciente!","warning"):cargarEjercicio(e.id_tipo_evaluacion)}}}]:[]})})),setTimeout((function(){new PickleTree({c_target:"div_tree",rowCreateCallback:e=>{},switchCallback:e=>{},drawCallback:()=>{},dragCallback:e=>{},dropCallback:e=>{},nodeRemoveCallback:e=>{},c_config:{foldedStatus:!0,logMode:!1,switchMode:!1,autoChild:!0,autoParent:!0,drag:!1,order:!1},c_data:i})}),1500)})).catch((e=>{console.log(e),Swal.fire("Error","Se ha Producido un Error:"+e,"error")}))},cargarPacientes=()=>{axios.get("listarpacientes").then((function(e){let a=e.data;console.log(a),a.forEach((e=>{document.getElementById("id_persona").innerHTML+="<option value='"+e.id_persona+"'>"+e.denominacion+"</option>"})),$("#id_persona").selectpicker("refresh"),$("#id_persona").val(""),$("#id_persona").selectpicker("render")})).catch((function(e){console.log(e)}))},cargarEdad=e=>{axios.get("listarpacientestutoresxid/"+e).then((function(e){let a=e.data[0];console.log(a),edad.value=a.edad})).catch((function(e){console.log(e)}))},cargarEjercicio=e=>{tblEjecutandoEjercicios.clear().draw(),axios.get("api/ejecutarevaluaciones/"+e).then((function(e){console.log(e.data);let a=e.data;Array.from(a).forEach((function(e){tblEjecutandoEjercicios.row.add([e.id_pregunta,e.titulo,e.descripcion,e.descripcion,e.cuerpo,e.imagen,e.respuestas,""]).draw(!1)}))})).catch((function(e){console.log(e)}))},limpiarFormulario=()=>{principal.show(),formulario.hide(),$("#id_persona").val(""),$("#id_persona").selectpicker("render"),edad.value="",tblEjecutandoEjercicios.clear().draw()};cargarPacientes(),cargarTest();
